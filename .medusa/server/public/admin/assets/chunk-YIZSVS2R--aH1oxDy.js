import{r as i,ca as g,cb as q,cc as v,k as E}from"./index-Dtvv6qDr.js";var S=()=>{const[a,r]=i.useState(""),[s,t]=i.useState(""),n=i.useCallback(g(o=>t(o),300),[]);return i.useEffect(()=>(n(a),()=>n.cancel()),[a,n]),{searchValue:a,onSearchValueChange:r,query:s||void 0}},I=({queryKey:a,queryFn:r,getOptions:s,defaultValue:t,defaultValueKey:n,pageSize:o=10,enabled:u=!0})=>{const{searchValue:f,onSearchValueChange:p,query:h}=S(),D=n||"id",{data:m}=q({queryKey:a,queryFn:async()=>r({[D]:t,limit:Array.isArray(t)?t.length:1}),enabled:!!t&&u}),{data:d,...y}=v({queryKey:[...a,h],queryFn:async({pageParam:e=0})=>await r({q:h,limit:o,offset:e}),initialPageParam:0,getNextPageParam:e=>e.count>e.offset+e.limit?e.offset+e.limit:void 0,placeholderData:E,enabled:u}),c=(d==null?void 0:d.pages.flatMap(e=>s(e)))??[],l=m?s(m):[],x=!y.isPending&&!c.length&&!f||!u;return t&&l.length&&!f&&l.forEach(e=>{c.find(b=>b.value===e.value)||c.unshift(e)}),{options:c,searchValue:f,onSearchValueChange:p,disabled:x,...y}};export{S as a,I as u};
